package com.example.testapp.controller;import com.example.testapp.dto.ImageResponse;import com.example.testapp.entity.Image;import com.example.testapp.server.ImageService;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.http.HttpStatus;import org.springframework.http.MediaType;import org.springframework.http.ResponseEntity;import org.springframework.web.bind.annotation.*;import org.springframework.web.multipart.MultipartFile;import java.io.IOException;import java.util.Optional;@RestController@RequestMapping("/api")public class ImageController {    @Autowired    private ImageService imageService;    @PostMapping("/add")    public ResponseEntity<String> upload(@RequestParam("file") MultipartFile file,@RequestParam("username") String username) {        try {            imageService.uploadImage(file, username);            return ResponseEntity.status(HttpStatus.CREATED).body("Image uploaded successfully");        } catch (Exception e) {            return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).body("Error uploading image");        }    }    @GetMapping("get/{id}")    public ResponseEntity<byte[]> getImage( @PathVariable int id ) {        try {            byte[] image = imageService.getImage(id);            return ResponseEntity.ok()                    .contentType(MediaType.IMAGE_JPEG)                    .body(image);        } catch (Exception e) {            throw new RuntimeException(e);        }    }    @GetMapping("/all/{id}")    public Image getAll (@PathVariable int id) {        return imageService.getAll(id);    }    @GetMapping("/getall/{id}")    public ResponseEntity<ImageResponse> getall (@PathVariable int id ) {        ImageResponse imageResponse = imageService.getAllData(id);        if (imageResponse != null) {            return ResponseEntity.ok(imageResponse);        } else {            return ResponseEntity.notFound().build();        }    }}